<!doctype html>
<html class="no-js" lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>repl rspec mocks</title>
    <link rel="stylesheet" href="https://dhbhdrzi4tiry.cloudfront.net/cdn/sites/foundation.min.css">
    <style> 
        #content{padding:20px;margin-top:2rem;margin-left:.5rem}#content ul{padding-left:2em}.post-nav .previous{display:inline-block;margin-left:.5em;margin-bottom:.5em}.post-nav .next{float:right;margin-right:.5em;margin-bottom:.5em}.vertical-banner{float:right;padding-left:20px}/*# sourceMappingURL=styles.css.map */

    </style>
</head>

<body>

    <!-- Start Top Bar -->
    <div class="top-bar">
        <div class="top-bar-left">
            <ul class="menu">
                <li><a href="/">The evolving ultrasaurus</a></li>
            </ul>
        </div>
        <div class="top-bar-right">
            <ul class="menu">
                <li><a href="/archives">Archives</a></li>
                <li><a href="/about">About</a></li>
                <li><a href="/speaking">Speaking</a></li>
                <li><a href="/contact">Contact</a></li>
            </ul>
        </div>
    </div>
    <!-- End Top Bar -->

    <div class="row" id="content">
                
<h1>repl rspec mocks</h1>

<p><em>April 05, 2011</em></p>


<p><a href="http://en.wikipedia.org/wiki/Read-eval-print_loop">REPL</a> (Read-Eval-Print-Loop) is a great way to learn. With Ruby, the experience is enabled with irb. Sometimes, to do this we need to peek into the innards of things, which I find to be an extremely effective way to explain mocks and stubs. It’s a regular part of my Ruby curriculum, even though I have needed to figure out the syntax three times in the last couple of years. (Many thanks to Jen-Mei Wu for the most recent iteration.) I still think it is worth it, even though it seems to change with crazy frequency.</p>
<p>Just in case anyone else ever wants to do this with current or previous versions of RSpec, I thought I would write it down before old versions become lost in the mists of time:</p>
<h2>RSpec 2.9</h2>
<p>[update for <a href="http://blog.blazingcloud.net/2012/04/14/repl-mocks-in-rspec-2-9/">repl mocks for RSpec 2.9 by Curtis Schofield</a>]</p>
<pre><code>
&gt;&gt; require 'rspec/mocks/standalone'
&gt;&gt;Time.stub(:now).and_return(10,20)
&gt;&gt;Time.now
10
&gt;&gt;Time.now
20
&gt;&gt;Time.now
20
 
</code></pre>
<h2>RSpec 2.5</h2>
<pre><code>
&gt;&gt; require 'rspec/mocks'
&gt;&gt; include RSpec::Mocks::Methods
&gt;&gt;Time.stub(:now).and_return(10,20)
&gt;&gt;Time.now
10
&gt;&gt;Time.now
20
&gt;&gt;Time.now
20
</code></pre>
<h2>RSpec 2.0</h2>
<pre><code>
&gt;&gt; require 'rspec/mocks'
&gt;&gt; require 'rspec/mocks/extensions/object'
&gt;&gt;Time.stub(:now).and_return(10,20)
&gt;&gt;Time.now
10
&gt;&gt;Time.now
20
&gt;&gt;Time.now
20
</code></pre>
<h2>RSpec 1.3</h2>
<pre><code>
&gt;&gt; require 'spec'
&gt;&gt; require 'spec/mocks'
&gt;&gt;Time.stub(:now).and_return(10,20)
&gt;&gt;Time.now
10
&gt;&gt;Time.now
20
&gt;&gt;Time.now
20
</code></pre>






<hr>
<nav class="post-nav">
    <span class="previous"><a href="/2011/04/cross-platform-frameworks-mobile-panel/">← mobile panel: cross-platform frameworks</span></a>
    
    <span class="next"><a href="/2011/04/on-choosing-rspec-as-a-test-framework/" rel="next">on choosing RSpec as a test framework →</span></a></span>
    
</nav>



    </div>

    <script src="https://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="https://dhbhdrzi4tiry.cloudfront.net/cdn/sites/foundation.js"></script>
    <script>
        $(document).foundation();
    </script>
</body>

</html>